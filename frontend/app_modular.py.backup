# Main streamlit application - modular version
import streamlit as st
from config import PAGE_CONFIG, initialize_session_state
from performance_improvements import get_minified_css, optimize_session_state
from ui_components import render_sidebar_navigation

# Configure page
st.set_page_config(**PAGE_CONFIG)

# Initialize optimizations
optimize_session_state()
initialize_session_state()

# Load optimized CSS
st.markdown(get_minified_css(), unsafe_allow_html=True)

def main():
    """Main application router with modular page loading"""
    # Render sidebar navigation
    render_sidebar_navigation()
    
    # Route to appropriate page
    current_page = st.session_state.get('current_page', 'Home')
    
    # Lazy load pages for better performance
    if current_page == 'Home':
        from pages.home import render_home_page
        render_home_page()
    
    elif current_page == 'Lab':
        from pages.lab import render_lab_page
        render_lab_page()
    
    elif current_page == 'Compare':
        from pages.compare import render_compare_page
        render_compare_page()
    
    elif current_page == 'Dashboard':
        from pages.dashboard import render_dashboard_page
        render_dashboard_page()
    
    elif current_page == 'Documentation':
        from pages.documentation import render_documentation_page
        render_documentation_page()
    
    else:
        st.error(f"Unknown page: {current_page}")
        st.session_state.current_page = 'Home'
        st.rerun()

if __name__ == "__main__":
    main()
